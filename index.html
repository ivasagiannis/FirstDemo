<!DOCTYPE html>
<html>
<head>
	<title>Image Base64 Encoder</title>
	<script>
		function encodeImageFileAsURL() {
			var filesSelected = document.getElementById("inputFileToLoad").files;
			if (filesSelected.length > 0) {
				var fileToLoad = filesSelected[0];

				var fileReader = new FileReader();

				fileReader.onload = function(fileLoadedEvent) {
					var srcData = fileLoadedEvent.target.result; // <--- data: base64
					var base64Data = srcData.substr(srcData.indexOf(',') + 1);
					document.getElementById("base64").innerHTML = base64Data;
					
					var url = "http://150.140.158.38:5000/predict_box";
					var data = { "image": base64Data };
					
					fetch(url, {
						method: "POST",
						body: JSON.stringify(data),
						headers: {
							"Content-Type": "application/json"
						},
						mode: "cors"
					})
					.then(response => response.json())
					.then(json => {
						document.getElementById("response").innerHTML = JSON.stringify(json);
						console.log(json);
					})
					.catch(error => console.error(error));
					
					document.getElementById("image").src = srcData;
				};

				fileReader.readAsDataURL(fileToLoad);
			}
		}
	</script>
</head>
<body>
	<h1>Image Base64 Encoder</h1>
	<form>
		<input type="file" onchange="encodeImageFileAsURL();" id="inputFileToLoad" accept=".jpg,.jpeg,.png,.gif">
	</form>
	<br>
	<div id="base64"></div>
	<br>
	<img id="image" src="#" alt="Selected Image">
	<br>
	<div id="response"></div>
</body>
</html>
